# vi:syntax=sh
#
# completion script for mmpack-build commands (to be sourced)

_mmpack_build_completion() {
    local IFS=$(echo -e '\v')
    COMPREPLY=( $(_ARGCOMPLETE_IFS="$IFS" \
        COMP_LINE="$COMP_LINE" \
        COMP_POINT="$COMP_POINT" \
        COMP_TYPE="$COMP_TYPE" \
        _ARGCOMPLETE_COMP_WORDBREAKS="$COMP_WORDBREAKS" \
        _ARGCOMPLETE=$ARGCOMPLETE \
        _ARGCOMPLETE_SUPPRESS_SPACE=1 \
        PYTHONPATH="/home/nbourdau/local/share/mmpack"${PYTHONPATH:+":$PYTHONPATH"} \
	python3 -m mmpack-build._argcomplete 8>&1 9>&2 1>/dev/null 2>&1) )
    if [[ $? != 0 ]]; then
        unset COMPREPLY
    elif [[ "$COMPREPLY" =~ [=/:]$ ]]; then
        compopt -o nospace
    fi
}
complete -F _mmpack_build_completion mmpack-build
